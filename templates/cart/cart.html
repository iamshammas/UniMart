{% extends 'base.html' %}

{% block title %}My Cart{% endblock %}

{% block content %}

<h2>My Cart</h2>

{% if cart_items %}
    <table border="1" cellpadding="10" cellspacing="0" width="100%">
        <tr>
            <th>Product</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Subtotal</th>
            <th>Action</th>
        </tr>

        {% for item in cart_items %}
            <tr>
                <td>{{ item.product.name }}</td>
                <td>₹ {{ item.product.price }}</td>

                <td>
                    <form method="post" action="{% url 'update_cart' item.id %}">
                        {% csrf_token %}
                        <input
                            type="number"
                            name="quantity"
                            value="{{ item.quantity }}"
                            min="1"
                            max="{{ item.product.stock }}"
                        >
                        <button type="submit">Update</button>
                    </form>
                </td>

                <td>₹ {{item.total}}</td>

                <td>
                    <form method="post" action="{% url 'remove_from_cart' item.id %}">
                        {% csrf_token %}
                        <button type="submit">Remove</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
    </table>

    <br>

    <h3>Total: ₹ {{ cart_items.total_amount }}</h3>

    <a href="/checkout/">Proceed to Checkout</a>

{% else %}
    <p>Your cart is empty.</p>
    <a href="/">Continue shopping</a>
{% endif %}

{% endblock %}
